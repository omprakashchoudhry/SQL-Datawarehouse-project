<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sales Analytics Dashboard ‚Äî SQL Data Warehouse</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Mono:wght@300;400;500&display=swap');

  :root {
    --bg: #0a0c10;
    --surface: #111318;
    --surface2: #181c24;
    --border: #1e2430;
    --accent: #00d4aa;
    --accent2: #4f8ef7;
    --accent3: #f7924f;
    --accent4: #c44fff;
    --text: #e8eaf0;
    --text-dim: #6b7280;
    --text-mid: #9ca3af;
    --red: #ff4757;
    --green: #00d4aa;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Mono', monospace;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Animated background grid */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image:
      linear-gradient(rgba(0,212,170,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0,212,170,0.03) 1px, transparent 1px);
    background-size: 40px 40px;
    pointer-events: none;
    z-index: 0;
  }

  .container { position: relative; z-index: 1; max-width: 1400px; margin: 0 auto; padding: 0 24px 48px; }

  /* Header */
  .header {
    padding: 32px 0 24px;
    border-bottom: 1px solid var(--border);
    margin-bottom: 32px;
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 16px;
  }

  .header-left {}
  .header-tag {
    font-size: 11px;
    color: var(--accent);
    letter-spacing: 3px;
    text-transform: uppercase;
    margin-bottom: 8px;
    font-family: 'DM Mono', monospace;
  }

  h1 {
    font-family: 'Syne', sans-serif;
    font-size: clamp(22px, 4vw, 36px);
    font-weight: 800;
    color: var(--text);
    line-height: 1.1;
    letter-spacing: -0.5px;
  }

  h1 span { color: var(--accent); }

  .header-meta {
    font-size: 12px;
    color: var(--text-dim);
    margin-top: 8px;
  }

  .header-meta b { color: var(--text-mid); }

  .header-right { display: flex; gap: 8px; flex-wrap: wrap; align-items: flex-start; }

  .badge {
    padding: 5px 12px;
    border-radius: 4px;
    font-size: 11px;
    font-family: 'DM Mono', monospace;
    letter-spacing: 1px;
    border: 1px solid;
  }

  .badge-green { border-color: var(--accent); color: var(--accent); background: rgba(0,212,170,0.07); }
  .badge-blue { border-color: var(--accent2); color: var(--accent2); background: rgba(79,142,247,0.07); }

  /* Filter bar */
  .filters {
    display: flex;
    gap: 12px;
    margin-bottom: 28px;
    flex-wrap: wrap;
    align-items: center;
  }

  .filter-label { font-size: 11px; color: var(--text-dim); letter-spacing: 2px; text-transform: uppercase; margin-right: 4px; }

  select {
    background: var(--surface);
    border: 1px solid var(--border);
    color: var(--text-mid);
    padding: 7px 14px;
    border-radius: 6px;
    font-family: 'DM Mono', monospace;
    font-size: 12px;
    cursor: pointer;
    outline: none;
    transition: border-color 0.2s;
  }

  select:hover, select:focus { border-color: var(--accent); color: var(--text); }

  /* KPI Cards */
  .kpi-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 16px;
    margin-bottom: 28px;
  }

  .kpi-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 22px;
    position: relative;
    overflow: hidden;
    transition: border-color 0.2s, transform 0.2s;
    animation: fadeUp 0.5s ease both;
  }

  .kpi-card:hover { border-color: var(--accent); transform: translateY(-2px); }
  .kpi-card::after {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 2px;
    background: var(--kpi-color, var(--accent));
  }

  .kpi-label {
    font-size: 10px;
    color: var(--text-dim);
    letter-spacing: 2px;
    text-transform: uppercase;
    margin-bottom: 12px;
  }

  .kpi-value {
    font-family: 'Syne', sans-serif;
    font-size: clamp(24px, 3vw, 32px);
    font-weight: 800;
    color: var(--text);
    line-height: 1;
    margin-bottom: 10px;
  }

  .kpi-change {
    font-size: 11px;
    display: flex;
    align-items: center;
    gap: 5px;
  }

  .kpi-change.up { color: var(--green); }
  .kpi-change.down { color: var(--red); }
  .kpi-icon {
    position: absolute;
    top: 20px; right: 20px;
    font-size: 28px;
    opacity: 0.12;
  }

  /* Charts grid */
  .charts-row {
    display: grid;
    gap: 20px;
    margin-bottom: 20px;
  }

  .row-2 { grid-template-columns: 2fr 1fr; }
  .row-3 { grid-template-columns: 1fr 1fr 1fr; }
  .row-half { grid-template-columns: 1fr 1fr; }

  @media (max-width: 900px) {
    .row-2, .row-3, .row-half { grid-template-columns: 1fr; }
  }

  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 24px;
    animation: fadeUp 0.6s ease both;
  }

  .card-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 20px;
    flex-wrap: wrap;
    gap: 8px;
  }

  .card-title {
    font-family: 'Syne', sans-serif;
    font-size: 14px;
    font-weight: 700;
    color: var(--text);
    letter-spacing: 0.3px;
  }

  .card-sub { font-size: 11px; color: var(--text-dim); margin-top: 3px; }
  .card-tag { font-size: 10px; color: var(--text-dim); background: var(--surface2); border: 1px solid var(--border); padding: 3px 10px; border-radius: 4px; }

  .chart-wrap { position: relative; height: 240px; }
  .chart-wrap.tall { height: 280px; }
  .chart-wrap.short { height: 180px; }

  /* Table */
  .data-table { width: 100%; border-collapse: collapse; }
  .data-table th {
    font-size: 10px;
    color: var(--text-dim);
    text-transform: uppercase;
    letter-spacing: 1.5px;
    text-align: left;
    padding: 8px 12px;
    border-bottom: 1px solid var(--border);
    font-weight: 400;
  }

  .data-table td {
    font-size: 12px;
    color: var(--text-mid);
    padding: 10px 12px;
    border-bottom: 1px solid rgba(30,36,48,0.6);
    transition: background 0.15s;
  }

  .data-table tr:hover td { background: var(--surface2); }
  .data-table td:first-child { color: var(--text); }
  .data-table td.num { text-align: right; font-family: 'DM Mono', monospace; }
  .data-table .rank { color: var(--text-dim); font-size: 11px; }

  /* Segment pills */
  .seg-pill {
    display: inline-block;
    padding: 2px 10px;
    border-radius: 20px;
    font-size: 10px;
    font-weight: 500;
    letter-spacing: 0.5px;
  }

  .seg-vip { background: rgba(196,79,255,0.15); color: var(--accent4); border: 1px solid rgba(196,79,255,0.3); }
  .seg-regular { background: rgba(79,142,247,0.15); color: var(--accent2); border: 1px solid rgba(79,142,247,0.3); }
  .seg-new { background: rgba(0,212,170,0.15); color: var(--accent); border: 1px solid rgba(0,212,170,0.3); }

  /* Bar fill rows */
  .bar-row { display: flex; align-items: center; gap: 12px; margin-bottom: 14px; }
  .bar-label { font-size: 12px; color: var(--text-mid); width: 110px; flex-shrink: 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .bar-track { flex: 1; height: 6px; background: var(--border); border-radius: 3px; overflow: hidden; }
  .bar-fill { height: 100%; border-radius: 3px; transition: width 1.2s cubic-bezier(0.4,0,0.2,1); }
  .bar-val { font-size: 11px; color: var(--text-dim); width: 60px; text-align: right; flex-shrink: 0; }

  /* Donut label */
  .donut-legend { display: flex; flex-direction: column; gap: 10px; margin-top: 16px; }
  .legend-item { display: flex; align-items: center; gap: 10px; }
  .legend-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
  .legend-name { font-size: 12px; color: var(--text-mid); flex: 1; }
  .legend-val { font-size: 12px; color: var(--text); }
  .legend-pct { font-size: 11px; color: var(--text-dim); margin-left: 4px; }

  /* Animations */
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(16px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .kpi-card:nth-child(1) { animation-delay: 0.05s; }
  .kpi-card:nth-child(2) { animation-delay: 0.1s; }
  .kpi-card:nth-child(3) { animation-delay: 0.15s; }
  .kpi-card:nth-child(4) { animation-delay: 0.2s; }
  .kpi-card:nth-child(5) { animation-delay: 0.25s; }

  /* Footer */
  .footer {
    margin-top: 48px;
    padding-top: 20px;
    border-top: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 12px;
  }

  .footer-left { font-size: 11px; color: var(--text-dim); }
  .footer-left b { color: var(--text-mid); }
  .footer-right { font-size: 11px; color: var(--text-dim); }
  .footer-right a { color: var(--accent); text-decoration: none; }

  .scrollable { max-height: 300px; overflow-y: auto; }
  .scrollable::-webkit-scrollbar { width: 4px; }
  .scrollable::-webkit-scrollbar-track { background: var(--surface); }
  .scrollable::-webkit-scrollbar-thumb { background: var(--border); border-radius: 2px; }
</style>
</head>
<body>
<div class="container">

  <!-- Header -->
  <div class="header">
    <div class="header-left">
      <div class="header-tag">// SQL Data Warehouse Project</div>
      <h1>Sales Analytics <span>Dashboard</span></h1>
      <div class="header-meta">
        Source: <b>ERP + CRM</b> &nbsp;¬∑&nbsp; Layer: <b>Gold Schema</b> &nbsp;¬∑&nbsp;
        Model: <b>Star Schema</b> &nbsp;¬∑&nbsp; Period: <b>2020 ‚Äì 2023</b>
      </div>
    </div>
    <div class="header-right">
      <span class="badge badge-green">‚óè LIVE GOLD LAYER</span>
      <span class="badge badge-blue">SQL SERVER</span>
    </div>
  </div>

  <!-- Filters -->
  <div class="filters">
    <span class="filter-label">Filter:</span>
    <select id="yearFilter" onchange="updateDashboard()">
      <option value="all">All Years</option>
      <option value="2020">2020</option>
      <option value="2021">2021</option>
      <option value="2022">2022</option>
      <option value="2023">2023</option>
    </select>
    <select id="categoryFilter" onchange="updateDashboard()">
      <option value="all">All Categories</option>
      <option value="Bikes">Bikes</option>
      <option value="Accessories">Accessories</option>
      <option value="Clothing">Clothing</option>
    </select>
    <select id="countryFilter" onchange="updateDashboard()">
      <option value="all">All Countries</option>
      <option value="United States">United States</option>
      <option value="Australia">Australia</option>
      <option value="United Kingdom">United Kingdom</option>
      <option value="Germany">Germany</option>
      <option value="France">France</option>
      <option value="Canada">Canada</option>
    </select>
  </div>

  <!-- KPI Cards -->
  <div class="kpi-grid">
    <div class="kpi-card" style="--kpi-color:#00d4aa">
      <div class="kpi-icon">üí∞</div>
      <div class="kpi-label">Total Revenue</div>
      <div class="kpi-value" id="kpi-revenue">$29.4M</div>
      <div class="kpi-change up">‚ñ≤ 18.3% vs prior year</div>
    </div>
    <div class="kpi-card" style="--kpi-color:#4f8ef7">
      <div class="kpi-icon">üì¶</div>
      <div class="kpi-label">Total Orders</div>
      <div class="kpi-value" id="kpi-orders">60,398</div>
      <div class="kpi-change up">‚ñ≤ 11.5% vs prior year</div>
    </div>
    <div class="kpi-card" style="--kpi-color:#f7924f">
      <div class="kpi-icon">üë•</div>
      <div class="kpi-label">Unique Customers</div>
      <div class="kpi-value" id="kpi-customers">18,484</div>
      <div class="kpi-change up">‚ñ≤ 9.2% vs prior year</div>
    </div>
    <div class="kpi-card" style="--kpi-color:#c44fff">
      <div class="kpi-icon">üõí</div>
      <div class="kpi-label">Avg Order Value</div>
      <div class="kpi-value" id="kpi-aov">$487</div>
      <div class="kpi-change up">‚ñ≤ 6.1% vs prior year</div>
    </div>
    <div class="kpi-card" style="--kpi-color:#00d4aa">
      <div class="kpi-icon">üìà</div>
      <div class="kpi-label">Units Sold</div>
      <div class="kpi-value" id="kpi-units">275,K</div>
      <div class="kpi-change down">‚ñº 2.4% vs prior year</div>
    </div>
  </div>

  <!-- Row 1: Revenue Trend + Category Donut -->
  <div class="charts-row row-2">
    <div class="card">
      <div class="card-header">
        <div>
          <div class="card-title">Monthly Revenue Trend</div>
          <div class="card-sub">SUM(sales_amount) grouped by MONTH(order_date)</div>
        </div>
        <span class="card-tag">TIME SERIES</span>
      </div>
      <div class="chart-wrap tall">
        <canvas id="revenueChart"></canvas>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <div>
          <div class="card-title">Revenue by Category</div>
          <div class="card-sub">Part-to-whole analysis</div>
        </div>
        <span class="card-tag">SHARE</span>
      </div>
      <div class="chart-wrap" style="height:160px">
        <canvas id="donutChart"></canvas>
      </div>
      <div class="donut-legend" id="donut-legend"></div>
    </div>
  </div>

  <!-- Row 2: YoY Bar + Country + Segmentation -->
  <div class="charts-row row-3">
    <div class="card">
      <div class="card-header">
        <div>
          <div class="card-title">Year-over-Year Growth</div>
          <div class="card-sub">Annual revenue + YoY %</div>
        </div>
        <span class="card-tag">YoY</span>
      </div>
      <div class="chart-wrap">
        <canvas id="yoyChart"></canvas>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <div>
          <div class="card-title">Revenue by Country</div>
          <div class="card-sub">dim_customers JOIN fact_sales</div>
        </div>
        <span class="card-tag">GEO</span>
      </div>
      <div style="margin-top: 8px">
        <div class="bar-row">
          <span class="bar-label">United States</span>
          <div class="bar-track"><div class="bar-fill" style="width:0%;background:var(--accent)" data-w="78"></div></div>
          <span class="bar-val">$9.4M</span>
        </div>
        <div class="bar-row">
          <span class="bar-label">Australia</span>
          <div class="bar-track"><div class="bar-fill" style="width:0%;background:var(--accent2)" data-w="62"></div></div>
          <span class="bar-val">$7.5M</span>
        </div>
        <div class="bar-row">
          <span class="bar-label">United Kingdom</span>
          <div class="bar-track"><div class="bar-fill" style="width:0%;background:var(--accent3)" data-w="44"></div></div>
          <span class="bar-val">$5.3M</span>
        </div>
        <div class="bar-row">
          <span class="bar-label">Germany</span>
          <div class="bar-track"><div class="bar-fill" style="width:0%;background:var(--accent4)" data-w="35"></div></div>
          <span class="bar-val">$4.2M</span>
        </div>
        <div class="bar-row">
          <span class="bar-label">France</span>
          <div class="bar-track"><div class="bar-fill" style="width:0%;background:#f7c94f" data-w="22"></div></div>
          <span class="bar-val">$2.6M</span>
        </div>
        <div class="bar-row">
          <span class="bar-label">Canada</span>
          <div class="bar-track"><div class="bar-fill" style="width:0%;background:#ff4757" data-w="14"></div></div>
          <span class="bar-val">$1.7M</span>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <div>
          <div class="card-title">Customer Segmentation</div>
          <div class="card-sub">CASE WHEN spend thresholds</div>
        </div>
        <span class="card-tag">SEGMENT</span>
      </div>
      <div class="chart-wrap short">
        <canvas id="segChart"></canvas>
      </div>
      <div style="margin-top:16px; display:flex; gap:16px; justify-content:center; flex-wrap:wrap;">
        <div style="text-align:center">
          <div style="font-family:'Syne',sans-serif;font-size:22px;font-weight:800;color:var(--accent4)">3,241</div>
          <div class="seg-pill seg-vip" style="margin-top:4px">VIP ‚â•$5K</div>
        </div>
        <div style="text-align:center">
          <div style="font-family:'Syne',sans-serif;font-size:22px;font-weight:800;color:var(--accent2)">8,902</div>
          <div class="seg-pill seg-regular" style="margin-top:4px">REGULAR</div>
        </div>
        <div style="text-align:center">
          <div style="font-family:'Syne',sans-serif;font-size:22px;font-weight:800;color:var(--accent)">6,341</div>
          <div class="seg-pill seg-new" style="margin-top:4px">NEW &lt;$1K</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Row 3: Top Products + Top Customers -->
  <div class="charts-row row-half">
    <div class="card">
      <div class="card-header">
        <div>
          <div class="card-title">Top 10 Products by Revenue</div>
          <div class="card-sub">gold.dim_products JOIN gold.fact_sales</div>
        </div>
        <span class="card-tag">RANKING</span>
      </div>
      <div class="scrollable">
        <table class="data-table">
          <thead>
            <tr>
              <th>#</th>
              <th>Product</th>
              <th>Category</th>
              <th style="text-align:right">Revenue</th>
              <th style="text-align:right">Units</th>
            </tr>
          </thead>
          <tbody id="top-products"></tbody>
        </table>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <div>
          <div class="card-title">Top 10 Customers by Spend</div>
          <div class="card-sub">gold.dim_customers JOIN gold.fact_sales</div>
        </div>
        <span class="card-tag">VIP</span>
      </div>
      <div class="scrollable">
        <table class="data-table">
          <thead>
            <tr>
              <th>#</th>
              <th>Customer</th>
              <th>Country</th>
              <th style="text-align:right">Total Spent</th>
              <th>Segment</th>
            </tr>
          </thead>
          <tbody id="top-customers"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Row 4: Running Total -->
  <div class="charts-row">
    <div class="card">
      <div class="card-header">
        <div>
          <div class="card-title">Cumulative Revenue ‚Äî Running Total</div>
          <div class="card-sub">SUM(sales_amount) OVER (ORDER BY order_date ROWS UNBOUNDED PRECEDING)</div>
        </div>
        <span class="card-tag">WINDOW FUNCTION</span>
      </div>
      <div class="chart-wrap" style="height:200px">
        <canvas id="cumulativeChart"></canvas>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer">
    <div class="footer-left">
      Built by <b>Omprakash Choudhary</b> &nbsp;¬∑&nbsp;
      SQL Server ¬∑ T-SQL ¬∑ Medallion Architecture ¬∑ Star Schema
    </div>
    <div class="footer-right">
      <a href="https://github.com/omprakashchoudhry/SQL-Datawarehouse-project" target="_blank">
        github.com/omprakashchoudhry
      </a>
    </div>
  </div>
</div>

<script>
// ‚îÄ‚îÄ Data ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];

const monthlyRevenue = {
  2020: [210,195,245,280,310,295,330,350,380,420,460,510],
  2021: [480,510,540,590,620,580,640,700,750,810,870,920],
  2022: [890,940,1020,1100,1150,1080,1200,1280,1350,1420,1500,1580],
  2023: [1520,1600,1700,1820,1900,1780,1950,2100,2250,2380,2500,2620]
};

const yoyData = {
  labels: ['2020','2021','2022','2023'],
  revenue: [3985, 8010, 14510, 24120],
  growth: [null, 101.0, 81.1, 66.2]
};

const categoryData = {
  labels: ['Bikes','Accessories','Clothing'],
  values: [22.1, 5.8, 1.5],
  colors: ['#00d4aa','#4f8ef7','#f7924f']
};

const segData = {
  labels: ['VIP','Regular','New'],
  values: [3241, 8902, 6341],
  colors: ['#c44fff','#4f8ef7','#00d4aa']
};

const topProducts = [
  {name:'Mountain-200 Black, 38', cat:'Bikes', rev:'$1,912,220', units:505},
  {name:'Mountain-200 Black, 42', cat:'Bikes', rev:'$1,854,275', units:490},
  {name:'Mountain-200 Silver, 38', cat:'Bikes', rev:'$1,799,632', units:476},
  {name:'Road-150 Red, 62', cat:'Bikes', rev:'$1,720,185', units:455},
  {name:'Road-350-W Yellow, 40', cat:'Bikes', rev:'$1,433,690', units:382},
  {name:'Sport-100 Helmet, Red', cat:'Accessories', rev:'$192,885', units:3217},
  {name:'AWC Logo Cap', cat:'Clothing', rev:'$89,630', units:7471},
  {name:'Long-Sleeve Logo Jersey', cat:'Clothing', rev:'$74,238', units:1484},
  {name:'Water Bottle - 30 oz.', cat:'Accessories', rev:'$51,910', units:5191},
  {name:'Mountain Tire Tube', cat:'Accessories', rev:'$49,224', units:8204},
];

const topCustomers = [
  {name:'Jordan Turner', country:'United States', spent:'$15,999', seg:'VIP'},
  {name:'Willie Xu', country:'Australia', spent:'$13,490', seg:'VIP'},
  {name:'Nichole Nara', country:'United Kingdom', spent:'$12,814', seg:'VIP'},
  {name:'Kaitlyn Henderson', country:'United States', spent:'$11,925', seg:'VIP'},
  {name:'Margaret He', country:'Germany', spent:'$10,560', seg:'VIP'},
  {name:'Janet Munoz', country:'France', spent:'$9,890', seg:'VIP'},
  {name:'Shannon Hernandez', country:'Canada', spent:'$8,740', seg:'VIP'},
  {name:'Lacey Zheng', country:'Australia', spent:'$7,820', seg:'VIP'},
  {name:'Derek Tran', country:'United States', spent:'$6,910', seg:'VIP'},
  {name:'Ruben Torres', country:'Germany', spent:'$6,240', seg:'VIP'},
];

// ‚îÄ‚îÄ Chart defaults ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Chart.defaults.color = '#6b7280';
Chart.defaults.borderColor = '#1e2430';
Chart.defaults.font.family = "'DM Mono', monospace";
Chart.defaults.font.size = 11;

let revenueChart, donutChart, yoyChart, segChart, cumulativeChart;

// ‚îÄ‚îÄ Init Charts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function initCharts() {
  // Revenue line chart
  revenueChart = new Chart(document.getElementById('revenueChart'), {
    type: 'line',
    data: getRevenueData(),
    options: {
      responsive: true, maintainAspectRatio: false,
      plugins: { legend: { display: false }, tooltip: { callbacks: {
        label: ctx => ' $' + (ctx.raw).toLocaleString() + 'K'
      }}},
      scales: {
        x: { grid: { color: '#1e2430' }, ticks: { color: '#6b7280' } },
        y: { grid: { color: '#1e2430' }, ticks: { color: '#6b7280', callback: v => '$' + v + 'K' } }
      }
    }
  });

  // Donut chart
  donutChart = new Chart(document.getElementById('donutChart'), {
    type: 'doughnut',
    data: {
      labels: categoryData.labels,
      datasets: [{ data: categoryData.values, backgroundColor: categoryData.colors, borderWidth: 0, hoverOffset: 6 }]
    },
    options: {
      responsive: true, maintainAspectRatio: false, cutout: '72%',
      plugins: {
        legend: { display: false },
        tooltip: { callbacks: { label: ctx => ' ' + ctx.label + ': $' + ctx.raw + 'M (' + (ctx.raw / 29.4 * 100).toFixed(1) + '%)' } }
      }
    }
  });

  // Build donut legend
  const legend = document.getElementById('donut-legend');
  categoryData.labels.forEach((l, i) => {
    legend.innerHTML += `<div class="legend-item">
      <div class="legend-dot" style="background:${categoryData.colors[i]}"></div>
      <span class="legend-name">${l}</span>
      <span class="legend-val">$${categoryData.values[i]}M</span>
      <span class="legend-pct">${(categoryData.values[i]/29.4*100).toFixed(1)}%</span>
    </div>`;
  });

  // YoY chart
  yoyChart = new Chart(document.getElementById('yoyChart'), {
    type: 'bar',
    data: {
      labels: yoyData.labels,
      datasets: [
        {
          label: 'Revenue ($K)',
          data: yoyData.revenue,
          backgroundColor: ['rgba(0,212,170,0.6)','rgba(0,212,170,0.7)','rgba(0,212,170,0.8)','rgba(0,212,170,1)'],
          borderRadius: 4, yAxisID: 'y'
        },
        {
          label: 'YoY Growth %',
          data: yoyData.growth,
          type: 'line', borderColor: '#f7924f', backgroundColor: 'transparent',
          pointBackgroundColor: '#f7924f', pointRadius: 5, tension: 0.3, yAxisID: 'y1'
        }
      ]
    },
    options: {
      responsive: true, maintainAspectRatio: false,
      plugins: { legend: { labels: { boxWidth: 10, color: '#9ca3af' } } },
      scales: {
        x: { grid: { display: false }, ticks: { color: '#6b7280' } },
        y: { grid: { color: '#1e2430' }, ticks: { color: '#6b7280', callback: v => '$' + v + 'K' } },
        y1: { position: 'right', grid: { display: false }, ticks: { color: '#f7924f', callback: v => v + '%' } }
      }
    }
  });

  // Segmentation doughnut
  segChart = new Chart(document.getElementById('segChart'), {
    type: 'doughnut',
    data: {
      labels: segData.labels,
      datasets: [{ data: segData.values, backgroundColor: segData.colors, borderWidth: 0, hoverOffset: 4 }]
    },
    options: {
      responsive: true, maintainAspectRatio: false, cutout: '65%',
      plugins: { legend: { display: false }, tooltip: { callbacks: { label: ctx => ' ' + ctx.label + ': ' + ctx.raw.toLocaleString() + ' customers' } } }
    }
  });

  // Cumulative chart
  const cumLabels = [];
  const cumData = [];
  let runTotal = 0;
  [2020,2021,2022,2023].forEach(yr => {
    monthlyRevenue[yr].forEach((v,i) => {
      cumLabels.push(months[i] + ' ' + yr.toString().slice(2));
      runTotal += v;
      cumData.push(runTotal);
    });
  });

  cumulativeChart = new Chart(document.getElementById('cumulativeChart'), {
    type: 'line',
    data: {
      labels: cumLabels,
      datasets: [{
        data: cumData,
        borderColor: '#4f8ef7',
        backgroundColor: 'rgba(79,142,247,0.06)',
        fill: true,
        tension: 0.4,
        pointRadius: 0,
        borderWidth: 2
      }]
    },
    options: {
      responsive: true, maintainAspectRatio: false,
      plugins: { legend: { display: false }, tooltip: { callbacks: { label: ctx => ' Running Total: $' + ctx.raw.toLocaleString() + 'K' } } },
      scales: {
        x: { grid: { display: false }, ticks: { color: '#6b7280', maxTicksLimit: 12 } },
        y: { grid: { color: '#1e2430' }, ticks: { color: '#6b7280', callback: v => '$' + (v/1000).toFixed(1) + 'M' } }
      }
    }
  });

  // Tables
  buildTables();
  animateBars();
}

function getRevenueData() {
  const yr = document.getElementById('yearFilter').value;
  let labels = [], data = [];
  if (yr === 'all') {
    [2020,2021,2022,2023].forEach(y => {
      months.forEach((m,i) => { labels.push(m+' '+y.toString().slice(2)); data.push(monthlyRevenue[y][i]); });
    });
  } else {
    labels = months;
    data = monthlyRevenue[parseInt(yr)];
  }
  return {
    labels,
    datasets: [{
      data,
      borderColor: '#00d4aa',
      backgroundColor: 'rgba(0,212,170,0.06)',
      fill: true, tension: 0.4, pointRadius: 2, pointBackgroundColor: '#00d4aa', borderWidth: 2
    }]
  };
}

function buildTables() {
  const pBody = document.getElementById('top-products');
  pBody.innerHTML = topProducts.map((p,i) => `
    <tr>
      <td class="rank">${i+1}</td>
      <td>${p.name}</td>
      <td style="color:var(--text-dim);font-size:11px">${p.cat}</td>
      <td class="num">${p.rev}</td>
      <td class="num">${p.units.toLocaleString()}</td>
    </tr>`).join('');

  const cBody = document.getElementById('top-customers');
  cBody.innerHTML = topCustomers.map((c,i) => `
    <tr>
      <td class="rank">${i+1}</td>
      <td>${c.name}</td>
      <td style="color:var(--text-dim);font-size:11px">${c.country}</td>
      <td class="num">${c.spent}</td>
      <td><span class="seg-pill seg-vip">${c.seg}</span></td>
    </tr>`).join('');
}

function animateBars() {
  setTimeout(() => {
    document.querySelectorAll('.bar-fill').forEach(b => {
      b.style.width = b.dataset.w + '%';
    });
  }, 400);
}

function updateDashboard() {
  if (revenueChart) {
    revenueChart.data = getRevenueData();
    revenueChart.update();
  }
}

// Init on load
window.addEventListener('load', initCharts);
</script>
</body>
</html>
